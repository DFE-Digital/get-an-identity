@page "/sign-in/trn/itt-provider"
@model TeacherIdentity.AuthServer.Pages.SignIn.Trn.IttProvider
@addTagHelper *, Joonasw.AspNetCore.SecurityHeaders
@{
    ViewBag.Title = Html.DisplayNameFor(m => m.HasIttProvider);
}

@section Styles
{
    <link rel="stylesheet" href="~/Styles/Components/accessible-autocomplete.min.css" asp-append-version="true" />
}

@section Scripts
{
    <script src="~/Scripts/Components/accessible-autocomplete.min.js"></script>
    <script asp-add-nonce="true">
        window.onload = function () {
            const inputName = '@nameof(Model.IttProviderName)';
            const select = document.querySelector(`select[name=${inputName}`);
            const container = select.parentElement;

            accessibleAutocomplete({
                element: container,
                id: inputName,
                source: @Html.Raw(Json.Serialize(Model.IttProviderNames))
            })

            container.removeChild(select);
            const input = container.querySelector('input');
            input.name = inputName;
        }
    </script>
}

@section BeforeContent {
    <govuk-back-link href="@LinkGenerator.TrnAwardedQts()" />
}

<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds-from-desktop">
        <form action="@LinkGenerator.TrnIttProvider()" method="post" asp-antiforgery="true">
            <govuk-radios asp-for="HasIttProvider">
                <govuk-radios-fieldset>
                    <govuk-radios-fieldset-legend is-page-heading="true" class="govuk-fieldset__legend--xl"/>

                    <govuk-radios-item value="True">Yes
                        <govuk-radios-item-conditional>
                            <govuk-select asp-for="IttProviderName">
                                <govuk-select-label class="govuk-label--s"/>
                                <govuk-select-item value=""></govuk-select-item>
                                @foreach (var ittProviderName in Model.IttProviderNames ?? Enumerable.Empty<string>())
                                {
                                    <govuk-select-item value="@ittProviderName">@ittProviderName</govuk-select-item>
                                }
                            </govuk-select>
                        </govuk-radios-item-conditional>
                    </govuk-radios-item>
                    <govuk-radios-item value="False">No</govuk-radios-item>
                </govuk-radios-fieldset>
            </govuk-radios>

            <govuk-button type="submit">Continue</govuk-button>
        </form>
    </div>
</div>
